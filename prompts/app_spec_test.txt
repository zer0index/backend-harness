# Document Upload & Processing API --- Product Requirements

## 1. Overview

This service is a minimal backend API that allows users to **upload
text-based documents** and run **simple processing operations** on those
uploaded documents.

A document is uploaded once and stored by the system. After upload, the
same document can be reused to trigger multiple processing operations
(e.g., counting words, extracting emails, generating a summary), without
requiring re-upload.

The API is intentionally simple and deterministic, designed to support
basic document analysis and transformation use cases while providing a
clean foundation for future expansion.

------------------------------------------------------------------------

## 2. Core Workflow

1.  Upload a document\
2.  Store it as a persistent resource\
3.  Run one or more processing jobs against it\
4.  Retrieve structured results

Documents are/block passive inputs. All processing is performed through
explicit job requests that reference an uploaded document.

------------------------------------------------------------------------

## 3. Key Concepts

### Document

A document represents uploaded text content provided by a user.\
It is immutable once uploaded and serves as the input source for all
processing jobs.

### Job

A job represents a single processing operation executed against a
document.\
Each job captures: - The operation performed - Execution status - Result
or error output

------------------------------------------------------------------------

## 4. Design Principles

-   **Minimal Surface Area**: Only essential endpoints are exposed.
-   **Upload-First Mental Model**: Documents are uploaded, not authored
    or edited.
-   **Reusable Inputs**: Uploaded documents can be processed multiple
    times.
-   **Deterministic Processing**: All operations return structured JSON.
-   **Strong User Isolation**: Users can only access their own data.

------------------------------------------------------------------------

## 5. Authentication

Authentication is handled via a required API key passed in the HTTP
header.

-   Header: `X-User-ID`
-   Missing or invalid key results in `401 Unauthorized`
-   All endpoints except health require authentication

------------------------------------------------------------------------

## 6. Resources

### Documents (Uploaded Files)

Fields: - `id` - `filename` - `content` - `user_id` - `uploaded_at`

Rules: - Documents are immutable after upload - Filename and content are
required - Users can only access their own documents

### Jobs (Processing Requests)

Fields: - `id` - `document_id` - `operation` - `status` - `result` -
`error` - `created_at` - `completed_at`

Rules: - Jobs inherit access control from documents - One operation per
job - Jobs execute synchronously

------------------------------------------------------------------------

## 7. Supported Processing Operations

-   `word_count`
-   `extract_emails`
-   `extract_urls`
-   `summarize`
-   `to_uppercase`

------------------------------------------------------------------------

## 8. API Endpoints

-   `GET /health`
-   `POST /documents` --- upload document
-   `GET /documents`
-   `GET /documents/{id}`
-   `DELETE /documents/{id}`
-   `POST /documents/{id}/jobs`
-   `GET /jobs/{id}`

------------------------------------------------------------------------

## 9. Scope and Non-Goals

### In Scope

-   Text-only uploads
-   Simple synchronous processing
-   Job tracking

### Out of Scope

-   Document editing
-   Async processing
-   User management
-   UI components

------------------------------------------------------------------------

## 10. Success Criteria

-   Documents can be uploaded once and reused
-   Processing results are deterministic
-   Access control is enforced
-   API remains minimal and extensible
